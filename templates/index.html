<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>耳机音质对比工具</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="logo">🎧 耳机音质对比工具</h1>
            <ul class="nav-menu">
                <li><a href="{{ url_for('index') }}" class="active">搜索对比</a></li>
                <li><a href="{{ url_for('upload') }}">数据上传</a></li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <!-- 搜索区域 -->
        <section class="search-section">
            <h2>搜索耳机</h2>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="输入品牌或型号 (如: Sony WH-1000XM4)">
                <button id="searchBtn">🔍 搜索</button>
            </div>
            <div id="searchResults" class="search-results"></div>
        </section>

        <!-- 已选择的耳机 -->
        <section class="selected-section">
            <h2>已选择的耳机 <span id="selectedCount">(0)</span></h2>
            <div id="selectedHeadphones" class="selected-headphones"></div>
            <button id="compareBtn" class="compare-btn" disabled>开始对比</button>
            <button id="clearBtn" class="clear-btn">清除所有</button>
        </section>

        <!-- 对比图表区域 -->
        <section id="comparisonSection" class="comparison-section" style="display: none;">
            <h2>对比结果</h2>

            <!-- 目标曲线选项 -->
            <div class="target-curves">
                <h3>目标曲线对比</h3>
                <label><input type="checkbox" class="target-curve" value="harman"> 哈曼曲线 (Harman)</label>
                <label><input type="checkbox" class="target-curve" value="ief"> IEF Target</label>
                <label><input type="checkbox" class="target-curve" value="freefield"> 自由场 (Free Field)</label>
                <label><input type="checkbox" class="target-curve" value="diffusefield"> 扩散场 (Diffuse Field)</label>
            </div>

            <!-- 频响曲线图 -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3>频响曲线 (Frequency Response)</h3>
                    <div class="chart-controls">
                        <label class="switch-label" id="originalDataToggle" style="display: none;">
                            <input type="checkbox" id="showOriginalData">
                            <span>显示原始数据</span>
                        </label>
                    </div>
                </div>
                <div class="axis-controls">
                    <div class="axis-group">
                        <label>X轴 (Hz):</label>
                        <input type="number" id="freqXMin" placeholder="最小值" value="20">
                        <span>-</span>
                        <input type="number" id="freqXMax" placeholder="最大值" value="20000">
                        <button class="axis-btn" id="freqXLock">🔓 自动</button>
                    </div>
                    <div class="axis-group">
                        <label>Y轴 (dB):</label>
                        <input type="number" id="freqYMin" placeholder="最小值" value="-10">
                        <span>-</span>
                        <input type="number" id="freqYMax" placeholder="最大值" value="10">
                        <button class="axis-btn" id="freqYLock">🔓 自动</button>
                    </div>
                    <div class="axis-group">
                        <label>Y轴刻度 (dB):</label>
                        <input type="number" id="freqYStep" placeholder="刻度单位" value="2" step="0.5" min="0.1">
                        <button class="axis-btn" id="freqYStepLock">🔓 自动</button>
                    </div>
                    <button class="axis-btn reset-btn" id="freqReset">重置</button>
                </div>
                <canvas id="frequencyChart"></canvas>
            </div>

            <!-- THD曲线图 -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3>总谐波失真 (THD)</h3>
                </div>
                <div class="axis-controls">
                    <div class="axis-group">
                        <label>X轴 (Hz):</label>
                        <input type="number" id="thdXMin" placeholder="最小值" value="20">
                        <span>-</span>
                        <input type="number" id="thdXMax" placeholder="最小值" value="20000">
                        <button class="axis-btn" id="thdXLock">🔓 自动</button>
                    </div>
                    <div class="axis-group">
                        <label>Y轴 (%):</label>
                        <input type="number" id="thdYMin" placeholder="最小值" value="0">
                        <span>-</span>
                        <input type="number" id="thdYMax" placeholder="最大值" value="1">
                        <button class="axis-btn" id="thdYLock">🔓 自动</button>
                    </div>
                    <div class="axis-group">
                        <label>Y轴刻度 (%):</label>
                        <input type="number" id="thdYStep" placeholder="刻度单位" value="0.1" step="0.05" min="0.01">
                        <button class="axis-btn" id="thdYStepLock">🔓 自动</button>
                    </div>
                    <button class="axis-btn reset-btn" id="thdReset">重置</button>
                </div>
                <canvas id="thdChart"></canvas>
            </div>

            <!-- R&B曲线图 -->
            <div class="chart-container">
                <div class="chart-header">
                    <h3>R&B 参数</h3>
                </div>
                <div class="axis-controls">
                    <div class="axis-group">
                        <label>X轴 (Hz):</label>
                        <input type="number" id="rnbXMin" placeholder="最小值" value="20">
                        <span>-</span>
                        <input type="number" id="rnbXMax" placeholder="最大值" value="20000">
                        <button class="axis-btn" id="rnbXLock">🔓 自动</button>
                    </div>
                    <div class="axis-group">
                        <label>Y轴:</label>
                        <input type="number" id="rnbYMin" placeholder="最小值" value="70">
                        <span>-</span>
                        <input type="number" id="rnbYMax" placeholder="最大值" value="100">
                        <button class="axis-btn" id="rnbYLock">🔓 自动</button>
                    </div>
                    <div class="axis-group">
                        <label>Y轴刻度:</label>
                        <input type="number" id="rnbYStep" placeholder="刻度单位" value="5" step="1" min="0.1">
                        <button class="axis-btn" id="rnbYStepLock">🔓 自动</button>
                    </div>
                    <button class="axis-btn reset-btn" id="rnbReset">重置</button>
                </div>
                <canvas id="rnbChart"></canvas>
            </div>
        </section>
    </main>

    <script src="{{ url_for('static', filename='js/data.js') }}?v=8"></script>
    <script src="{{ url_for('static', filename='js/targetCurves.js') }}?v=8"></script>
    <script src="{{ url_for('static', filename='js/chartConfig.js') }}?v=8"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}?v=8"></script>
    <script src="{{ url_for('static', filename='js/mainExtensions.js') }}?v=8"></script>
</body>
</html>
